
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://piano35-edb.github.io/configuring/configuring_wal_archiving_replication/">
      
      
        <link rel="prev" href="../configuring_ssh/">
      
      
        <link rel="next" href="../configuring_wal_streaming/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.26">
    
    
      
        <title>Configuring WAL Archiving and Replication - Barman  (Backup and Recovery Manager for PostgreSQL)</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#archiving-features" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Barman  (Backup and Recovery Manager for PostgreSQL)" class="md-header__button md-logo" aria-label="Barman  (Backup and Recovery Manager for PostgreSQL)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Barman  (Backup and Recovery Manager for PostgreSQL)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Configuring WAL Archiving and Replication
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../license/" class="md-tabs__link">
          
  
    
  
  About

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../getting-started/" class="md-tabs__link">
        
  
    
  
  Getting Started

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../download/" class="md-tabs__link">
        
  
    
  
  Download

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../version_support/" class="md-tabs__link">
          
  
    
  
  Installing

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../configuration_files/" class="md-tabs__link">
          
  
    
  
  Configuring

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../customizing/binary_paths/" class="md-tabs__link">
          
  
    
  
  Customizing

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../backing_up/requirements/" class="md-tabs__link">
          
  
    
  
  Backing Up

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../recovering/using_recovery/" class="md-tabs__link">
          
  
    
  
  Recovering

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../commands/using_commands/" class="md-tabs__link">
          
  
    
  
  Commands

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../upgrade_paths/" class="md-tabs__link">
          
  
    
  
  Upgrading

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../troubleshooting/" class="md-tabs__link">
        
  
    
  
  Troubleshooting

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../scripts/backup-scripts/" class="md-tabs__link">
          
  
    
  
  Scripts

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../external_content/blogs/" class="md-tabs__link">
          
  
    
  
  Blog

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Barman  (Backup and Recovery Manager for PostgreSQL)" class="md-nav__button md-logo" aria-label="Barman  (Backup and Recovery Manager for PostgreSQL)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Barman  (Backup and Recovery Manager for PostgreSQL)
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    About
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            About
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../license/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../release-notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Release Notes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../support/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Support
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../features/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Features
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    F.A.Q.
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../philosophy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Philosophy
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../download/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Download
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Installing
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Installing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../version_support/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Version Support
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reqs_limits/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Requirements and Limitations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Architecture
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Configuring
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Configuring
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuration_files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration Files
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuring_options/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuring Options
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuration_examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration Examples
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuring_new_server/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuring a New Server
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuring_ssh/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuring SSH
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Configuring WAL Archiving and Replication
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Configuring WAL Archiving and Replication
  </span>
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#archiving-features" class="md-nav__link">
    <span class="md-ellipsis">
      Archiving features
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Archiving features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wal-compression" class="md-nav__link">
    <span class="md-ellipsis">
      WAL compression
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#synchronous-wal-streaming" class="md-nav__link">
    <span class="md-ellipsis">
      Synchronous WAL streaming
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#catalog-management-features" class="md-nav__link">
    <span class="md-ellipsis">
      Catalog management features
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Catalog management features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#minimum-redundancy-safety" class="md-nav__link">
    <span class="md-ellipsis">
      Minimum redundancy safety
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#retention-policies" class="md-nav__link">
    <span class="md-ellipsis">
      Retention policies
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Retention policies">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#retention-policy-based-on-redundancy" class="md-nav__link">
    <span class="md-ellipsis">
      Retention policy based on redundancy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#retention-policy-based-on-recovery-window" class="md-nav__link">
    <span class="md-ellipsis">
      Retention policy based on recovery window
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scope" class="md-nav__link">
    <span class="md-ellipsis">
      Scope
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-retention-policies-work" class="md-nav__link">
    <span class="md-ellipsis">
      How retention policies work
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration-and-syntax" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration and syntax
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#syntax-for-retention_policy" class="md-nav__link">
    <span class="md-ellipsis">
      Syntax for retention_policy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#syntax-for-wal_retention_policy" class="md-nav__link">
    <span class="md-ellipsis">
      Syntax for wal_retention_policy
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-up" class="md-nav__link">
    <span class="md-ellipsis">
      Setting up
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#server-configuration-file" class="md-nav__link">
    <span class="md-ellipsis">
      Server configuration file
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuring_wal_streaming/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuring WAL Streaming
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuring_windows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuring Windows
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Customizing
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Customizing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../customizing/binary_paths/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Binary Paths
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../customizing/cluster_integration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cluster Integration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../customizing/configuration_models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration Models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../customizing/geographical_redundancy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Geographical Redundancy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../customizing/lock_file_directory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lock File Directory
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../customizing/parallel_jobs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parallel Jobs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../customizing/passive_nodes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Passive Nodes
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Backing Up
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Backing Up
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../backing_up/requirements/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Requirements
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../backing_up/bandwidth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bandwidth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../backing_up/cloud-backups/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cloud and snapshot backups
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../backing_up/compression/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Compression
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../backing_up/concurrent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Concurrent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../backing_up/immediate_checkpoint/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Immediate Checkpoint
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../backing_up/incremental/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Incremental Backups
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../backing_up/local_backups/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Local Backups
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../backing_up/streaming_backups/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Streaming Backups
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../backing_up/rsync_ssh/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Backups with rsync / SSH
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../backing_up/cloud_snapshots/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Backups with cloud snapshots
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Recovering
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Recovering
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../recovering/using_recovery/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using recovery
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../recovering/cloud-restores/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cloud and snapshot restores
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../recovering/recovering_from_snapshot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Recovering from snapshot backups
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Commands
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Commands
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/using_commands/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using commands
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/barman-cli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Barman CLI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_3" >
        
          
          <label class="md-nav__link" for="__nav_10_3" id="__nav_10_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    General commands
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_3">
            <span class="md-nav__icon md-icon"></span>
            General commands
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/general/commands_general/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General commands
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/general/cron/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cron
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/general/diagnose/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Diagnose
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/general/list-servers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    List-servers
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_4" >
        
          
          <label class="md-nav__link" for="__nav_10_4" id="__nav_10_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Backup commands
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_4">
            <span class="md-nav__icon md-icon"></span>
            Backup commands
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/backup/check-backup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    check-backup
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/backup/show-backup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    show-backup
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_5" >
        
          
          <label class="md-nav__link" for="__nav_10_5" id="__nav_10_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Cloud commands
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_5">
            <span class="md-nav__icon md-icon"></span>
            Cloud commands
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/cloud/cloud_commands_using/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using Cloud commands
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/cloud/cloud-backup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cloud backup
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/cloud/cloud-backup-delete/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cloud backup delete
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/cloud/cloud-backup-keep/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cloud backup keep
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/cloud/cloud-backup-list/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cloud backup list
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/cloud/cloud-backup-show/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cloud backup show
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/cloud/cloud-check-wal-archive/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cloud check-wal-archive
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/cloud/cloud-restore/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cloud restore
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/cloud/cloud-wal-archive/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cloud wal-archive
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/cloud/cloud-wal-restore/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cloud wal-restore
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_6" >
        
          
          <label class="md-nav__link" for="__nav_10_6" id="__nav_10_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Server commands
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_6">
            <span class="md-nav__icon md-icon"></span>
            Server commands
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/server/commands_server/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Server commands
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/server/archive-wal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    archive-wal
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/server/backup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    backup
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/server/check/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    check
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/server/config-update/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    config-update
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/server/config-switch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    config-switch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/server/delete/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    delete
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/server/generate-manifest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    generate-manifest
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/server/get-wal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    get-wal
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/server/keep/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    keep
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/server/list-backups/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    list-backups
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/server/list-files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    list-files
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/server/list-servers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    list-servers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/server/lock-directory-cleanup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lock-directory-cleanup
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/server/put-wal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    put-wal
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/server/rebuild-xlogdb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rebuild-xlogdb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/server/receive-wal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    receive-wal
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/server/recover/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    recover
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/server/replication-status/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    replication-status
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/server/show-servers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    show-servers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/server/status/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    status
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/server/switch-wal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    switch-wal
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/server/sync-info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sync-info
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/server/verify-backup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    verify-backup
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/server/wal-restore/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    wal-restore
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/server/wal-archive/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    wal-archive
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Upgrading
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            Upgrading
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../upgrade_paths/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrade Paths
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Troubleshooting
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13" >
        
          
          <label class="md-nav__link" for="__nav_13" id="__nav_13_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Scripts
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_13">
            <span class="md-nav__icon md-icon"></span>
            Scripts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scripts/backup-scripts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Backup scripts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scripts/backup-delete-scripts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Backup delete scripts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scripts/cloud-hook-scripts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cloud hook scripts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scripts/hook-scripts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hook scripts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scripts/wal-archive-scripts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wal archive scripts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scripts/wal-delete-scripts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wal delete scripts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scripts/recovery-scripts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Recovery scripts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scripts/script-variables/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Script variables
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_14" >
        
          
          <label class="md-nav__link" for="__nav_14" id="__nav_14_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Blog
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_14">
            <span class="md-nav__icon md-icon"></span>
            Blog
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../external_content/blogs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blogs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../external_content/books/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Books
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../external_content/tutorials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Configuring WAL Archiving and Replication</h1>

<h2 id="archiving-features">Archiving features<a class="headerlink" href="#archiving-features" title="Permanent link">&para;</a></h2>
<h3 id="wal-compression">WAL compression<a class="headerlink" href="#wal-compression" title="Permanent link">&para;</a></h3>
<p>The <code>barman cron</code> command will compress WAL files if the compression option is set in the configuration file. This option allows five values:</p>
<table>
<thead>
<tr>
<th><strong>Value</strong></th>
<th><strong>Description</strong></th>
<th><strong>Note</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>bzip2</code></td>
<td>Used for Bzip2 compression</td>
<td>Requires the <code>bzip2</code> utility</td>
</tr>
<tr>
<td><code>gzip</code></td>
<td>Used for Gzip compression</td>
<td>Requires the <code>gzip</code> utility</td>
</tr>
<tr>
<td><code>pybzip2</code></td>
<td>Used for Bzip2 compression</td>
<td>Uses Python's internal compression module</td>
</tr>
<tr>
<td><code>pygzip</code></td>
<td>Used for Gzip compression</td>
<td>Uses Python's internal compression module</td>
</tr>
<tr>
<td><code>pigz</code></td>
<td>Used for Pigz compression</td>
<td>Requires the <code>pigz</code> utility</td>
</tr>
<tr>
<td><code>custom</code></td>
<td>Used for custom compression</td>
<td>Requires configuring following options: <code>custom_compression_filter</code>, <code>custom_decompression_filter</code>, <code>custom_compression_magic</code></td>
</tr>
</tbody>
</table>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>All methods but <code>pybzip2</code> and <code>pygzip</code> require <code>barman archive-wal</code> to fork a new process.</p>
</div>
<h3 id="synchronous-wal-streaming">Synchronous WAL streaming<a class="headerlink" href="#synchronous-wal-streaming" title="Permanent link">&para;</a></h3>
<p>Barman can also reduce the Recovery Point Objective to zero, by collecting the transaction WAL files like a synchronous standby server would.</p>
<p>To configure such a scenario, the Barman server must be configured to archive WALs via the streaming connection, and the <code>receive-walprocess</code> should figure as a synchronous standby of the PostgreSQL server.</p>
<p>Use the following steps to configure it:</p>
<ol>
<li>
<p>Retrieve the application name of the Barman <code>receive-wal</code> process with the <code>show-servers</code> command:
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>barman@backup<span class="se">\$</span><span class="w"> </span>barman<span class="w"> </span>show-servers<span class="w"> </span>pg**<span class="se">\|</span>**grep<span class="w"> </span>streaming_archiver_name
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>streaming_archiver_name:<span class="w"> </span>barman_receive_wal
</span></code></pre></div></p>
</li>
<li>
<p>Add the application name to the <code>postgresql.conf</code> file as a synchronous standby:
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="nv">synchronous_standby_names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;barman_receive_wal&#39;</span>
</span></code></pre></div></p>
</li>
<li>Restart the PostgreSQL server for the configuration to be reloaded.</li>
</ol>
<div class="admonition success">
<p class="admonition-title">Success</p>
<p>If the server has been configured correctly, the <code>replication-status</code> command should show the <code>receive_wal</code> process as a synchronous streaming client:</p>
</div>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="p">[</span><span class="n">root</span><span class="o">@</span><span class="n">backup</span><span class="w"> </span><span class="err">\</span><span class="o">~</span><span class="p">]</span><span class="err">\</span><span class="o">#</span><span class="w"> </span><span class="n">barman</span><span class="w"> </span><span class="n">replication</span><span class="o">-</span><span class="n">status</span><span class="w"> </span><span class="n">pg</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="n">Status</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">streaming</span><span class="w"> </span><span class="n">clients</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="s1">&#39;pg&#39;</span><span class="p">:</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="k">Current</span><span class="w"> </span><span class="n">xlog</span><span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">master</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="o">/</span><span class="mi">9000098</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="nb">Number</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">streaming</span><span class="w"> </span><span class="n">clients</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="mi">1</span><span class="err">\</span><span class="p">.</span><span class="w"> </span><span class="o">*</span><span class="err">\</span><span class="o">#</span><span class="mi">1</span><span class="w"> </span><span class="n">Sync</span><span class="w"> </span><span class="n">WAL</span><span class="w"> </span><span class="n">streamer</span><span class="o">*</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="n">Application</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="n">barman_receive_wal</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="n">Sync</span><span class="w"> </span><span class="n">stage</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="o">/</span><span class="mi">3</span><span class="w"> </span><span class="n">Remote</span><span class="w"> </span><span class="k">write</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="n">Communication</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">TCP</span><span class="o">/</span><span class="n">IP</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="n">IP</span><span class="w"> </span><span class="n">Address</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">139</span><span class="p">.</span><span class="mi">59</span><span class="p">.</span><span class="mi">135</span><span class="p">.</span><span class="mi">32</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">58262</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="k">Host</span><span class="p">:</span><span class="w"> </span><span class="o">-</span>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="k">User</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">streaming_barman</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a><span class="k">Current</span><span class="w"> </span><span class="k">state</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">streaming</span><span class="w"> </span><span class="p">(</span><span class="n">sync</span><span class="p">)</span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a><span class="n">Replication</span><span class="w"> </span><span class="n">slot</span><span class="p">:</span><span class="w"> </span><span class="n">barman</span>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a><span class="n">WAL</span><span class="w"> </span><span class="n">sender</span><span class="w"> </span><span class="n">PID</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">2501</span>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a><span class="n">Started</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">2016</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">16</span><span class="w"> </span><span class="mi">10</span><span class="p">:</span><span class="mi">33</span><span class="p">:</span><span class="mi">01</span><span class="p">.</span><span class="mi">725883</span><span class="o">+</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a><span class="n">Sent</span><span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="o">/</span><span class="mi">9000098</span><span class="w"> </span><span class="p">(</span><span class="n">diff</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">B</span><span class="p">)</span>
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a><span class="k">Write</span><span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="o">/</span><span class="mi">9000098</span><span class="w"> </span><span class="p">(</span><span class="n">diff</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">B</span><span class="p">)</span>
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a><span class="n">Flush</span><span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="o">/</span><span class="mi">9000098</span><span class="w"> </span><span class="p">(</span><span class="n">diff</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">B</span><span class="p">)</span>
</span></code></pre></div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>This is only an example of configuration, to show you that Barman is eligible to be a synchronous standby node. It doesn't imply to use ONLY Barman. You can read <a href="https://www.postgresql.org/docs/current/static/warm-standby.html#SYNCHRONOUS-REPLICATION"><em>"Synchronous Replication"</em></a> from the PostgreSQL documentation for further information on this topic.</p>
</div>
<h2 id="catalog-management-features">Catalog management features<a class="headerlink" href="#catalog-management-features" title="Permanent link">&para;</a></h2>
<h3 id="minimum-redundancy-safety">Minimum redundancy safety<a class="headerlink" href="#minimum-redundancy-safety" title="Permanent link">&para;</a></h3>
<p>You can define the minimum number of periodic backups for a PostgreSQL server, using the global/per server configuration option  <code>minimum_redundancy</code>.  It is set to 0 by default.</p>
<p>When set to any number greater than 0, Barman makes sure that at any time, you'll have at least that number of backups in a server catalog.</p>
<p>This can protect from accidental <code>barman delete</code> operations.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Make sure that your retention policy settings don't collide with minimum redundancy requirements. Regularly check Barman's log for messages on this topic.</p>
</div>
<h2 id="retention-policies">Retention policies<a class="headerlink" href="#retention-policies" title="Permanent link">&para;</a></h2>
<p>Barman supports retention policies for backups.</p>
<p>A backup retention policy is a user-defined policy that determines how long backups and related archive logs (Write Ahead Log segments) need to be retained for recovery procedures.</p>
<p>Barman can retain the periodic backups required to satisfy the current retention policy and any archived WAL files required for the complete recovery of those backups.</p>
<p>You can define a retention policy in terms of backup redundancy (how many periodic backups) or a recovery window (how long).</p>
<h3 id="retention-policy-based-on-redundancy">Retention policy based on redundancy<a class="headerlink" href="#retention-policy-based-on-redundancy" title="Permanent link">&para;</a></h3>
<p>With a redundancy-based retention policy, you can determine how many periodic backups to keep. A redundancy-based retention policy is contrasted with retention policies that use a recovery window.</p>
<h3 id="retention-policy-based-on-recovery-window">Retention policy based on recovery window<a class="headerlink" href="#retention-policy-based-on-recovery-window" title="Permanent link">&para;</a></h3>
<p>A recovery window is one type of Barman backup retention policy, in which you specify a period of time and Barman ensures retention of backups and/or archived WAL files required for point-in-time recovery to any time during the recovery window. The interval always ends with the current time and extends back in time for the number of days specified by the user. </p>
<p>For example, if the retention policy is set for a recovery window of seven days, and the current time is 9:30 AM on Friday, Barman retains the backups required to allow point-in-time recovery back to 9:30 AM on the previous Friday.</p>
<h3 id="scope">Scope<a class="headerlink" href="#scope" title="Permanent link">&para;</a></h3>
<p>Retention policies can be defined for:</p>
<ul>
<li><strong>PostgreSQL periodic base backups</strong>: through the <code>retention_policy</code> configuration option</li>
<li><strong>Archive logs for Point-In-Time-Recovery</strong>: through the <code>wal_retention_policy</code> configuration option</li>
</ul>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>In a temporal dimension, archive logs must be included in the time window of periodic backups.</p>
</div>
<p>The two typical use cases are full or partial point-in-time recovery.</p>
<p><strong>Full point in time recovery scenario</strong></p>
<ul>
<li>The base backups and archive logs share the same retention policy, allowing you to recover at any point in time from the first available backup.</li>
</ul>
<p><strong>Partial point in time recovery scenario</strong></p>
<ul>
<li>The base backup retention policy is wider than that of archive logs.  You can keep full or weekly backups of the last six months, but archive logs for the last four weeks <em>(granting to recover at any point in time starting from the last four periodic weekly backups)</em>.</li>
</ul>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Barman implements only the <strong>full point in time recovery</strong> scenario, by constraining the <code>wal_retention_policy</code> option to <code>main</code>.</p>
</div>
<h3 id="how-retention-policies-work">How retention policies work<a class="headerlink" href="#how-retention-policies-work" title="Permanent link">&para;</a></h3>
<p>Retention policies in Barman can be:</p>
<ul>
<li><strong>automated</strong>: Enforced by <code>barman cron</code>.</li>
<li><strong>manual</strong>: Barman reports obsolete backups and allows you to delete them.</li>
</ul>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Barman doesn't implement manual enforcement. This feature is planned for future versions.</p>
</div>
<h3 id="configuration-and-syntax">Configuration and syntax<a class="headerlink" href="#configuration-and-syntax" title="Permanent link">&para;</a></h3>
<p>Retention policies can be defined through the following configuration options:</p>
<table>
<thead>
<tr>
<th><strong>Option</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>retention_policy</code></td>
<td>For base backup retention</td>
</tr>
<tr>
<td><code>wal_retention_policy</code></td>
<td>For archive logs retention</td>
</tr>
<tr>
<td><code>retention_policy_mode</code></td>
<td>Can only be set to <code>auto</code> <em>(retention policies are automatically enforced by the <code>barman cron</code> command)</em></td>
</tr>
</tbody>
</table>
<p>These configuration options can be defined both at a global level and a server level, allowing maximum flexibility in a multi-server environment.</p>
<h3 id="syntax-for-retention_policy">Syntax for <code>retention_policy</code><a class="headerlink" href="#syntax-for-retention_policy" title="Permanent link">&para;</a></h3>
<p>The general syntax for a base backup retention policy through <code>retention_policy</code> is:
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="nv">retention_policy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">{</span>REDUNDANCY<span class="w"> </span>value<span class="w"> </span><span class="se">\|</span><span class="w"> </span>RECOVERY<span class="w"> </span>WINDOW<span class="w"> </span>OF<span class="w"> </span>value<span class="w"> </span><span class="o">{</span>DAYS<span class="w"> </span><span class="se">\|</span><span class="w"> </span>WEEKS<span class="w"> </span><span class="se">\|</span><span class="w"> </span>MONTHS<span class="o">}}</span>
</span></code></pre></div>
Where:</p>
<ul>
<li>Syntax is case insensitive</li>
<li>Value is an integer and is &gt; 0</li>
</ul>
<p><strong>redundancy retention policy</strong></p>
<ul>
<li><code>value</code> must be greater than or equal to the server minimum redundancy level.  If that value isn't assigned, a warning is generated. The first valid backup is the value of the backup in a reverse-ordered time series.</li>
</ul>
<p><strong>recovery window policy</strong></p>
<ul>
<li>The point of recoverability is: <em>(current time - window - the first valid backup is the first available backup before the point of recoverability)</em>. Its value in a reverse-ordered time series must be greater than or equal to the server minimum redundancy level.  If it isn't assigned to that value, a warning is generated.</li>
</ul>
<p>By default, <code>retention_policy</code> is empty <em>(no retention enforced)</em>.</p>
<h3 id="syntax-for-wal_retention_policy">Syntax for <code>wal_retention_policy</code><a class="headerlink" href="#syntax-for-wal_retention_policy" title="Permanent link">&para;</a></h3>
<p>The only allowed value for <code>wal_retention_policy</code> is the value <code>main</code>.  It maps the retention policy of archive logs to that of base backups.</p>
<h2 id="setting-up">Setting up<a class="headerlink" href="#setting-up" title="Permanent link">&para;</a></h2>
<p>Before proceeding, ensure you've properly configured PostgreSQL on <strong>pg</strong> to accept streaming replication connections from the Barman server.  For more information, see the following sections in the PostgreSQL documentation:</p>
<ul>
<li><a href="https://www.postgresql.org/docs/current/static/role-attributes.html">Role attributes</a></li>
<li><a href="https://www.postgresql.org/docs/current/static/auth-pg-hba-conf.html">The pg_hba.conf file</a></li>
<li><a href="https://www.postgresql.org/docs/current/static/protocol-replication.html">Setting up standby servers using streaming replication</a></li>
</ul>
<p>Use the following steps to set it up:</p>
<ol>
<li>Configure the <code>wal_level</code> parameter to ensure that all the useful information necessary for a backup to be coherent are included in the transaction log file:
<div class="language-bash highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="nv">wal_level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;replica&#39;</span><span class="se">\|</span><span class="s1">&#39;logical&#39;</span>
</span></code></pre></div></li>
<li>Restart the PostgreSQL server for the configuration to be reloaded.</li>
</ol>
<h2 id="server-configuration-file">Server configuration file<a class="headerlink" href="#server-configuration-file" title="Permanent link">&para;</a></h2>
<p>Create a new file, called <code>pg.conf</code> in the <code>/etc/barman.d</code> directory, with the following content:
<div class="language-bash highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>**<span class="o">[</span>pg<span class="o">]</span>**
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="nv">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Our main PostgreSQL server&quot;</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="nv">conninfo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">host</span><span class="o">=</span>pg<span class="w"> </span><span class="nv">user</span><span class="o">=</span>barman<span class="w"> </span><span class="nv">dbname</span><span class="o">=</span>postgres
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="nv">backup_method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>postgres
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>*<span class="se">\#</span><span class="w"> </span><span class="nv">backup_method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>rsync*
</span></code></pre></div>
The <code>conninfo</code> option is set accordingly to the section <em>"Preliminary steps: PostgreSQL connection"</em>.</p>
<p>If you plan to use the streaming connection for WAL archiving or to create a backup of your server, add the <code>streaming_conninfo</code> parameter in your server configuration file:
<div class="language-bash highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="nv">streaming_conninfo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">host</span><span class="o">=</span>pg<span class="w"> </span><span class="nv">user</span><span class="o">=</span>streaming_barman<span class="w"> </span><span class="nv">dbname</span><span class="o">=</span>postgres
</span></code></pre></div>
This value must be chosen accordingly as described in the section <em>"Preliminary steps: PostgreSQL connection"</em>.</p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; 2011-2024  <a href="https://www.enterprisedb.com"  target="_blank" rel="noopener"></a>  <a href="https://www.enterprisedb.com/contact" target"_blank" rel="noopener">EnterpriseDB Corporation.  All rights reserved. </a> 

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://www.youtube.com/user/EnterpriseDB" target="_blank" rel="noopener" title="www.youtube.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/EDBPostgres" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/company/enterprisedb" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.facebook.com/EDBpostgres" target="_blank" rel="noopener" title="www.facebook.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M512 256C512 114.6 397.4 0 256 0S0 114.6 0 256c0 120 82.7 220.8 194.2 248.5V334.2h-52.8V256h52.8v-33.7c0-87.1 39.4-127.5 125-127.5 16.2 0 44.2 3.2 55.7 6.4V172c-6-.6-16.5-1-29.6-1-42 0-58.2 15.9-58.2 57.2V256h83.6l-14.4 78.2H287v175.9C413.8 494.8 512 386.9 512 256z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.tracking", "navigation.path", "navigation.indexes", "navigation.top", "toc.integrate", null, "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotate", "content.code.copy", "content.code.select", "header.autohide"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.ad660dcc.min.js"></script>
      
    
  </body>
</html>